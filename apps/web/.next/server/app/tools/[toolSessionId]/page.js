(()=>{var e={};e.id=144,e.ids=[144],e.modules={2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},9693:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>i.a,__next_app__:()=>p,originalPathname:()=>u,pages:()=>c,routeModule:()=>m,tree:()=>d}),s(7011),s(1034),s(5291);var a=s(9132),l=s(5459),r=s(1584),i=s.n(r),n=s(7131),o={};for(let e in n)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>n[e]);s.d(t,o);let d=["",{children:["tools",{children:["[toolSessionId]",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,7011)),"/Users/xm/Desktop/work_project/backend/helios_kernel/apps/web/src/app/tools/[toolSessionId]/page.tsx"]}]},{}]},{}]},{layout:[()=>Promise.resolve().then(s.bind(s,1034)),"/Users/xm/Desktop/work_project/backend/helios_kernel/apps/web/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,5291,23)),"next/dist/client/components/not-found-error"]}],c=["/Users/xm/Desktop/work_project/backend/helios_kernel/apps/web/src/app/tools/[toolSessionId]/page.tsx"],u="/tools/[toolSessionId]/page",p={require:s,loadChunk:()=>Promise.resolve()},m=new a.AppPageRouteModule({definition:{kind:l.x.APP_PAGE,page:"/tools/[toolSessionId]/page",pathname:"/tools/[toolSessionId]",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},9781:(e,t,s)=>{Promise.resolve().then(s.bind(s,5441))},5441:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>k});var a=s(870),l=s(8250),r=s(2400),i=s(9642),n=s(2646);let o=(0,n.Z)("messages-square",[["path",{d:"M16 10a2 2 0 0 1-2 2H6.828a2 2 0 0 0-1.414.586l-2.202 2.202A.71.71 0 0 1 2 14.286V4a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2z",key:"1n2ejm"}],["path",{d:"M20 9a2 2 0 0 1 2 2v10.286a.71.71 0 0 1-1.212.502l-2.202-2.202A2 2 0 0 0 17.172 19H10a2 2 0 0 1-2-2v-1",key:"1qfcsi"}]]);var d=s(8501);let c=(0,n.Z)("download",[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]]),u=(0,n.Z)("chevron-right",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);var p=s(8472),m=s(437),x=s(9285),h=s(3206),f=s(8720);function k(){let e=(0,r.useParams)(),t="string"==typeof e.toolSessionId?e.toolSessionId:"",{locale:s}=(0,x.Q)(),n=(0,l.useMemo)(()=>"zh"===s?{title:"工具会话中心",subtitle:"统一查看本地扫描会话与系统已连接会话。",refresh:"刷新",all:"全部",codex:"Codex",claude:"Claude Code",collabTag:"协作创建",userTag:"用户打开",localTag:"本地私有",active:"活跃",paused:"暂停",transcriptTitle:"会话记录",noTranscript:"暂无可展示记录。",openDrawer:"查看记录",sourceFilter:"来源筛选",sourceAll:"全部",sourceLocal:"本地扫描",sourceLinked:"系统已连接",providerFilter:"工具",importBtn:"导入",importedOk:"导入成功",importFail:"导入失败",prev:"上一页",next:"下一页",page:"页",of:"共",emptyList:"当前筛选条件下没有会话。"}:{title:"Tool Session Hub",subtitle:"View local scanned sessions and linked sessions in one list.",refresh:"Refresh",all:"All",codex:"Codex",claude:"Claude Code",collabTag:"From collab",userTag:"Opened by user",localTag:"Local private",active:"Active",paused:"Paused",transcriptTitle:"Transcript",noTranscript:"No transcript entries.",openDrawer:"Open transcript",sourceFilter:"Source Filter",sourceAll:"All",sourceLocal:"Local Scanned",sourceLinked:"Linked",providerFilter:"Provider",importBtn:"Import",importedOk:"Imported",importFail:"Import failed",prev:"Prev",next:"Next",page:"Page",of:"of",emptyList:"No sessions under current filters."},[s]),[k,v]=(0,l.useState)("all"),[g,j]=(0,l.useState)("all"),[b,w]=(0,l.useState)([]),[y,N]=(0,l.useState)([]),[S,_]=(0,l.useState)(null),[I,P]=(0,l.useState)(!1),[z,C]=(0,l.useState)([]),[T,A]=(0,l.useState)(""),[L,$]=(0,l.useState)(1),[M,E]=(0,l.useState)(!1),q=(0,l.useMemo)(()=>{let e=[];if("all"===g||"local"===g)for(let t of y)e.push({kind:"local",data:t});if("all"===g||"linked"===g)for(let t of b)e.push({kind:"linked",data:t});return e.sort((e,t)=>Date.parse(t.data.lastActiveAt)-Date.parse(e.data.lastActiveAt))},[g,y,b]),D=Math.max(1,Math.ceil(q.length/8)),F=(0,l.useMemo)(()=>q.slice((L-1)*8,8*L),[q,L]);async function O(){let e="all"===k?"/v1/tool-sessions":`/v1/tool-sessions?provider=${k}`,t=await (0,m.LK)(e);return w(t),t}async function Z(){let e="all"===k?"/v1/local-tool-sessions?limit=300":`/v1/local-tool-sessions?provider=${k}&limit=300`,t=await (0,m.LK)(e);return N(t),t}async function U(){let[e,s]=await Promise.all([O(),Z()]);if(S){if("linked"===S.kind){let t=e.find(e=>e.toolSessionId===S.data.toolSessionId);if(t){_({kind:"linked",data:t});return}}if("local"===S.kind){let e=s.find(e=>e.toolSessionId===S.data.toolSessionId&&e.provider===S.data.provider);if(e){_({kind:"local",data:e});return}}}let a=e.find(e=>e.toolSessionId===t);if(a){_({kind:"linked",data:a});return}let l=s.find(e=>e.toolSessionId===t);if(l){_({kind:"local",data:l});return}if(e.length>0){_({kind:"linked",data:e[0]});return}if(s.length>0){_({kind:"local",data:s[0]});return}_(null)}function R(e){return"COLLAB"===e?n.collabTag:n.userTag}async function B(e){try{await (0,m.uz)("/v1/tool-sessions",{collab_session_id:"user_manual",task_id:`task_import_${Date.now()}`,provider:e.provider,source:"USER_OPENED",tool_session_id:e.toolSessionId,summary_150:e.summary150}),A(n.importedOk),await U()}catch(t){let e=t instanceof Error?t.message:n.importFail;A(`${n.importFail}: ${e}`)}}let W=M&&I?(0,p.createPortal)((0,a.jsxs)(a.Fragment,{children:[a.jsx("button",{type:"button","aria-label":"close drawer backdrop",className:"fixed inset-0 z-40 bg-black/20",onClick:()=>P(!1)}),a.jsx("aside",{className:"fixed inset-y-0 right-0 z-50 h-screen w-full border-l bg-white shadow-2xl transition-transform duration-300 sm:w-[80%] lg:w-1/2 lg:min-w-[640px]",children:(0,a.jsxs)("div",{className:"flex h-full flex-col",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between border-b px-5 py-4",children:[(0,a.jsxs)("div",{children:[a.jsx("p",{className:"text-xs uppercase tracking-[0.2em] text-muted-foreground",children:n.transcriptTitle}),a.jsx("h3",{className:"text-lg font-bold",children:S?.data.toolSessionId??"-"}),a.jsx("p",{className:"text-xs text-muted-foreground",children:S?.kind==="local"?n.localTag:S?.kind==="linked"?R(S.data.source):"-"})]}),a.jsx(f.z,{variant:"ghost",size:"icon",onClick:()=>P(!1),children:a.jsx(i.Z,{className:"h-4 w-4"})})]}),(0,a.jsxs)("div",{className:"flex-1 space-y-2 overflow-y-auto p-5",children:[S?.kind==="linked"?a.jsx("div",{className:"rounded-xl border bg-muted/40 p-3",children:a.jsx("p",{className:"text-sm",children:S.data.lastSummary150||"-"})}):null,S?.kind==="local"?(0,a.jsxs)("div",{className:"rounded-xl border bg-muted/40 p-3",children:[a.jsx("p",{className:"text-sm",children:S.data.summary150||"-"}),a.jsx("p",{className:"mt-1 text-xs text-muted-foreground",children:S.data.cwd||S.data.sourcePath})]}):null,0===z.length?a.jsx("p",{className:"text-sm text-muted-foreground",children:n.noTranscript}):null,z.map((e,t)=>(0,a.jsxs)("div",{className:"rounded-xl border p-3",children:[(0,a.jsxs)("div",{className:"mb-1 flex items-center gap-2 text-xs text-muted-foreground",children:[a.jsx(o,{className:"h-3.5 w-3.5"}),e.role,e.timestamp?(0,a.jsxs)("span",{children:["\xb7 ",e.timestamp]}):null]}),a.jsx("p",{className:"whitespace-pre-wrap text-sm",children:e.text})]},`${t}_${e.text.slice(0,20)}`))]})]})})]}),document.body):null;return(0,a.jsxs)("section",{className:"relative",children:[(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex flex-wrap items-center justify-between gap-3",children:[(0,a.jsxs)("div",{children:[a.jsx("h2",{className:"text-2xl font-extrabold",children:n.title}),a.jsx("p",{className:"text-sm text-muted-foreground",children:n.subtitle})]}),(0,a.jsxs)("div",{className:"flex flex-wrap items-center gap-2",children:[a.jsx(f.z,{variant:"all"===g&&"all"===k?"default":"outline",size:"sm",onClick:()=>{j("all"),v("all")},children:n.sourceAll}),a.jsx(f.z,{variant:"linked"===g?"default":"outline",size:"sm",onClick:()=>j("linked"),children:n.sourceLinked}),a.jsx(f.z,{variant:"codex"===k?"default":"outline",size:"sm",onClick:()=>v("codex"),children:n.codex}),a.jsx(f.z,{variant:"claude_code"===k?"default":"outline",size:"sm",onClick:()=>v("claude_code"),children:n.claude}),(0,a.jsxs)(f.z,{variant:"outline",size:"sm",onClick:()=>void U(),children:[a.jsx(d.Z,{className:"mr-2 h-4 w-4"}),n.refresh]})]})]}),(0,a.jsxs)("div",{className:"space-y-4",children:[T?a.jsx("p",{className:"text-xs text-muted-foreground",children:T}):null,0===q.length?a.jsx("p",{className:"text-sm text-muted-foreground",children:n.emptyList}):null,F.map((e,t)=>{let s=e.data,l="local"===e.kind;return(0,a.jsxs)("div",{role:"button",tabIndex:0,className:`flex cursor-pointer items-center justify-between rounded-xl border p-3 ${S&&S.kind===e.kind&&("local"===e.kind?S.data.toolSessionId===e.data.toolSessionId&&S.data.provider===e.data.provider:S.data.toolSessionId===e.data.toolSessionId)?"border-primary bg-primary/5":""}`,onClick:()=>{_(e),P(!0)},onKeyDown:t=>{("Enter"===t.key||" "===t.key)&&(t.preventDefault(),_(e),P(!0))},children:[(0,a.jsxs)("div",{className:"min-w-0 flex-1 text-left",children:[a.jsx("p",{className:"truncate font-semibold",children:s.toolSessionId}),(0,a.jsxs)("p",{className:"truncate text-xs text-muted-foreground",children:[s.provider," \xb7 ",l?s.cwd||s.sourcePath:s.collabSessionId]}),(0,a.jsxs)("div",{className:"mt-1 flex gap-2",children:[a.jsx(h.C,{variant:"outline",children:l?n.localTag:R(s.source)}),l?null:a.jsx(h.C,{variant:"ACTIVE"===s.status?"default":"secondary",children:"ACTIVE"===s.status?n.active:n.paused})]})]}),(0,a.jsxs)("div",{className:"ml-3 flex items-center gap-2",children:[l?(0,a.jsxs)(f.z,{variant:"outline",size:"sm",onClick:e=>{e.stopPropagation(),B(s)},children:[a.jsx(c,{className:"mr-2 h-3.5 w-3.5"}),n.importBtn]}):null,a.jsx(f.z,{variant:"outline",size:"sm",onClick:t=>{t.stopPropagation(),_(e),P(!0)},children:n.openDrawer}),a.jsx(u,{className:"h-4 w-4 text-muted-foreground"})]})]},`${e.kind}_${s.toolSessionId}_${t}`)}),q.length>0?(0,a.jsxs)("div",{className:"flex items-center justify-between border-t pt-3",children:[(0,a.jsxs)("p",{className:"text-xs text-muted-foreground",children:[n.page," ",L," ",n.of," ",D]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[a.jsx(f.z,{variant:"outline",size:"sm",disabled:L<=1,onClick:()=>$(e=>Math.max(1,e-1)),children:n.prev}),a.jsx(f.z,{variant:"outline",size:"sm",disabled:L>=D,onClick:()=>$(e=>Math.min(D,e+1)),children:n.next})]})]}):null]})]}),W]})}},437:(e,t,s)=>{"use strict";s.d(t,{LK:()=>n,uz:()=>o});let a=process.env.NEXT_PUBLIC_API_BASE_URL??"http://127.0.0.1:1999/api";function l(e){return e.endsWith("/")?e.slice(0,-1):e}function r(e,t){let s=l(e),a=t.startsWith("/")?t:`/${t}`;return`${s}${a}`}async function i(e,t){let s=r(a,e),i=await fetch(s,t);if(404===i.status&&!function(e){try{let t=new URL(e);return l(t.pathname).endsWith("/api")}catch{return l(e).endsWith("/api")}}(a)&&(e.startsWith("/v1/")||e.startsWith("/internal/"))){let s=r(`${l(a)}/api`,e);i=await fetch(s,t)}return i}async function n(e){let t=await i(e);if(!t.ok)throw Error(`Request failed with status ${t.status} (${e})`);return await t.json()}async function o(e,t){let s=await i(e,{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify(t)});if(!s.ok){let t=await s.text();throw Error(`Request failed with status ${s.status} (${e}): ${t}`)}return await s.json()}},8501:(e,t,s)=>{"use strict";s.d(t,{Z:()=>a});let a=(0,s(2646).Z)("refresh-ccw",[["path",{d:"M21 12a9 9 0 0 0-9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"14sxne"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M3 12a9 9 0 0 0 9 9 9.75 9.75 0 0 0 6.74-2.74L21 16",key:"1hlbsb"}],["path",{d:"M16 16h5v5",key:"ccwih5"}]])},9642:(e,t,s)=>{"use strict";s.d(t,{Z:()=>a});let a=(0,s(2646).Z)("x",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])},7011:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});let a=(0,s(7971).createProxy)(String.raw`/Users/xm/Desktop/work_project/backend/helios_kernel/apps/web/src/app/tools/[toolSessionId]/page.tsx#default`)}};var t=require("../../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),a=t.X(0,[695,554],()=>s(9693));module.exports=a})();